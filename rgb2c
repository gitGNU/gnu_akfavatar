#!/usr/bin/awk -f

# rgb2c - Convert rgb.txt into C-code
#
# Copyright (c) 2009,2012 Andreas K. Foerster
# Copying and distribution of this file, with or without modification,
# are permitted in any medium without royalty provided the copyright
# notice and this notice are preserved.  This file is offered as-is,
# without any warranty.

BEGIN	{ if (name == "") name = "palette"
	  if (default == "") default = "0x000000" # must be a string

	  print "/* automatically generated by rgb2c */"
	  print ""
	  print "#ifndef _RGB2C"
	  print "#define _RGB2C"
	  print ""
	  print "#define DEFAULT_COLOR " default
	  print ""
	  print "static const struct { int number; const char *name; }"
	  print name "[] = {"
	  printf "  {DEFAULT_COLOR, \"default\"}"
	}

/^!/	{ next }

NF < 4	{ next }

	{ print ","
	  printf "  {0x%02X%02X%02X, \"", $1, $2, $3
	  for (i = 4; i <= NF; i++)
	    if (i < NF) printf "%s ", $i
	           else printf "%s\"}", $i
	}

END	{ print "\n};"
	  print "\n#endif /* _RGB2C */"
	}
