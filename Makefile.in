# Makefile template for AKFAvatar
# Copyright (C) 2007,2008,2009,2010,2011,2012,2013
# Andreas K. Foerster
#
# This Makefile template is free software; you have unlimited permission
# to copy, distribute and modify it.

# Ogg Vorbis files with how many channels should be supported?
# output is limited to 2 channels, but this value may be higher
vorbis_max_channels = 8

SHELL = /bin/sh
INSTALL_PROGRAM = $(INSTALL) -c -m 755
INSTALL_DATA = $(INSTALL) -c -m 644

# does not depend on prefix!
LUA_PATH = /usr/local/share/lua/5.2/
LUA_CPATH = /usr/local/lib/lua/5.2/

SOX = sox
ROFF = groff
ENSCRIPT = enscript

DEFAULT_COLOR = 0xE0D5C5

# Soundfile for the alert (\a)
# may be any format that sox supports
# should be higher quality; it will be converted into the needed format
ALERT = $(srcdir)/alert.flac

# names for packages
PKGNAME = $(pkgname)-$(pkgversion)
BINPKGNAME = lua-akfavatar-$(pkgversion).bin


.PHONY: all check doc txt info install install-strip installdirs uninstall \
	html dvi pdf ps man install-html install-dvi install-pdf install-ps \
	clean mostlyclean distclean maintainer-clean maintainerclean dist \
	mingw dist-mingw about

LUA_MODULES = \
	  $(srcdir)/lua/akfavatar/dir.??.about \
	  $(srcdir)/lua/akfavatar/questionary.lua \
	  $(srcdir)/lua/akfavatar/person.lua \
	  $(srcdir)/lua/akfavatar/utf8.lua \
	  $(srcdir)/lua/akfavatar/ar.lua \
	  $(srcdir)/lua/akfavatar/avtdemo.lua

all: $(TARGET)

dist-bin: $(DISTBIN)

default: libakfavatar.so libakfavatar.a libavtaddons.a example about \
	lua-akfavatar lua-akfavatar-dyn lua-akfavatar-linuxfb \
	lua-akfavatar.so base64.so akfavatar-term.so \
	akfavatar-vorbis.so akfavatar-graphic.so
	@echo '*'
	@echo '* use "make install" or "make install-strip"'
	@echo '* with root-privileges to install it.'
	@echo '*'

nolua: libakfavatar.so libakfavatar.a libavtaddons.a example about
	@echo '*'
	@echo '* use "make install" or "make install-strip"'
	@echo '* with root-privileges to install it.'
	@echo '*'


Makefile: $(srcdir)/configure $(srcdir)/Makefile.in ./config.status
	./config.status

version.h: $(srcdir)/configure
	./config.status

# when you use the static lib you have to link with SDL
example: $(srcdir)/example.c libakfavatar.a
	$(CC) -I$(srcdir) $(CFLAGS) -o $@ $(srcdir)/example.c \
	  libakfavatar.a $(SDL_LDFLAGS) $(LDFLAGS)

# lua-akfavatar dynamically linked
lua-akfavatar-dyn: lua-akfavatar-prg.o lua-avt.o libavtaddons.a
	$(CC) -o $@ lua-akfavatar-prg.o lua-avt.o \
	     libavtaddons.a -L. -lakfavatar $(LUA_LDFLAGS) $(LDFLAGS)

# lua-akfavatar statically linked with AKFAvatar
lua-akfavatar: lua-akfavatar-prg.o lua-avt.o libavtaddons.a libakfavatar.a
	$(CC) -o $@ lua-akfavatar-prg.o lua-avt.o \
	     libavtaddons.a libakfavatar.a \
	     $(LUA_LDFLAGS) $(SDL_LDFLAGS) $(LDFLAGS) -Wl,-E

# lua-akfavatar for Linux framebuffer
lua-akfavatar-linuxfb: lua-akfavatar-prg.o lua-avt.o avatar-linuxfb.o \
	           audio-dummy.o audio-common-dummy.o \
                   libavtaddons.a libakfavatar.a
	-$(CC) -s -o $@ lua-akfavatar-prg.o lua-avt.o avatar-linuxfb.o \
	     audio-dummy.o audio-common-dummy.o \
	     libavtaddons.a libakfavatar.a \
	     $(LUA_LDFLAGS) $(LDFLAGS)

avatar-linuxfb.o: $(srcdir)/avatar-linuxfb.c $(srcdir)/akfavatar.h \
          $(srcdir)/avtinternals.h
	-$(CC) -I$(srcdir) -I. $(CFLAGS) -c -o $@ $(srcdir)/avatar-linuxfb.c

avatar-linuxfb.lo: $(srcdir)/avatar-linuxfb.c $(srcdir)/akfavatar.h \
          $(srcdir)/avtinternals.h
	-$(CC) -I$(srcdir) -I. $(CFLAGS) -c -fpic -o $@ $(srcdir)/avatar-linuxfb.c

libakfavatar.a: $(OBJAVATAR).o $(OBJAUDIO).o avatar.o avatar-default.o \
	        ISO-8859-1.o UTF-8.o avtencoding.o charencoding.o \
	        avtpalette.o font.o version.o avtdata.o \
	        audio-common.o avttiming.o avtmenu.o avtxbm.o avtxpm.o avtbmp.o \
	        avtgraphic.o
	$(AR) rcu $@ $(OBJAVATAR).o $(OBJAUDIO).o avatar.o \
	             ISO-8859-1.o UTF-8.o avtencoding.o charencoding.o \
	             audio-common.o avtdata.o avatar-default.o avtpalette.o \
	             font.o version.o avttiming.o avtmenu.o avtxbm.o avtxpm.o \
	             avtbmp.o avtgraphic.o
	-$(RANLIB) $@

libavtaddons.a: filechooser.o avtterm.o avttermsys.o arch.o \
                avtccio.o avtcwio.o avtreadfile.o basedir.o \
                colorchooser.o avtvorbis.o stb_vorbis.o langposix.o \
                charmaps.o ISO-8859-2.o ISO-8859-15.o \
                KOI8-R.o KOI8-U.o cp1252.o \
                sysencoding.o
	$(AR) rcu $@ filechooser.o avtterm.o avttermsys.o arch.o \
	             avtccio.o avtcwio.o avtreadfile.o basedir.o \
	             colorchooser.o avtvorbis.o stb_vorbis.o langposix.o \
	             charmaps.o ISO-8859-2.o ISO-8859-15.o \
	             KOI8-R.o KOI8-U.o cp1252.o \
	             sysencoding.o
	-$(RANLIB) $@

libakfavatar.so: $(OBJAVATAR).lo $(OBJAUDIO).lo avatar.lo avatar-default.lo \
	         ISO-8859-1.lo UTF-8.lo avtencoding.lo charencoding.lo \
	         avtpalette.lo font.lo version.lo avtdata.lo \
	         audio-common.lo avttiming.lo avtmenu.lo avtxbm.lo avtxpm.lo \
	         avtbmp.lo avtgraphic.lo
	$(CC) -shared \
	      -Wl,-soname,$(SONAME) -o $(LIBNAME) -fpic \
	      $(OBJAVATAR).lo $(OBJAUDIO).lo avatar.lo avatar-default.lo \
	      ISO-8859-1.lo UTF-8.lo avtencoding.lo charencoding.lo \
	      avtpalette.lo font.lo version.lo avtdata.lo \
	      audio-common.lo avttiming.lo avtmenu.lo avtxbm.lo avtxpm.lo \
	      avtbmp.lo avtgraphic.lo \
	      $(SDL_LDFLAGS) $(LDFLAGS)
	-ln -sf $(LIBNAME) $(SONAME)
	-ln -sf $(LIBNAME) libakfavatar.so

version.o: $(srcdir)/version.c $(srcdir)/akfavatar.h version.h
	$(CC) $(CFLAGS) -c -o $@ -I. $(srcdir)/version.c

version.lo: $(srcdir)/version.c $(srcdir)/akfavatar.h version.h
	$(CC) $(CFLAGS) -fpic -c -o $@ -I. $(srcdir)/version.c

# alert.au should be in the sourcecode-distribution
$(srcdir)/alert.au: $(ALERT)
	$(SOX) $(ALERT) --comment "" -e mu-law -c 1 $@ rate 16k

alert.c: $(srcdir)/alert.au $(srcdir)/data2c.awk
	$(AWK) -f $(srcdir)/data2c.awk -v name=avt_alert_data \
	  $(srcdir)/alert.au > $@

avtmenu.o: $(srcdir)/avtmenu.c $(srcdir)/akfavatar.h \
	       $(srcdir)/avtinternals.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/avtmenu.c

avtmenu.lo: $(srcdir)/avtmenu.c $(srcdir)/akfavatar.h $(srcdir)/avtinternals.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/avtmenu.c

filechooser.o: $(srcdir)/filechooser.c $(srcdir)/akfavatar.h \
	       $(srcdir)/avtaddons.h $(srcdir)/avtinternals.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/filechooser.c

filechooser.lo: $(srcdir)/filechooser.c $(srcdir)/avtaddons.h \
                $(srcdir)/avtinternals.h  $(srcdir)/akfavatar.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/filechooser.c

colorchooser.o: $(srcdir)/colorchooser.c $(srcdir)/avtaddons.h $(srcdir)/akfavatar.h
	$(CC) $(CFLAGS) -c -o $@ $(srcdir)/colorchooser.c

colorchooser.lo: $(srcdir)/colorchooser.c $(srcdir)/avtaddons.h $(srcdir)/akfavatar.h
	$(CC) -I$(srcdir) $(CFLAGS) $(SDL_CFLAGS) -c -fpic -o $@ \
	  $(srcdir)/colorchooser.c

charencoding.o: $(srcdir)/charencoding.c $(srcdir)/avtaddons.h $(srcdir)/akfavatar.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/charencoding.c

charencoding.lo: $(srcdir)/charencoding.c $(srcdir)/avtaddons.h $(srcdir)/akfavatar.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/charencoding.c

sysencoding.o: $(srcdir)/sysencoding.c $(srcdir)/avtaddons.h $(srcdir)/akfavatar.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/sysencoding.c

sysencoding.lo: $(srcdir)/sysencoding.c $(srcdir)/avtaddons.h $(srcdir)/akfavatar.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/sysencoding.c

charmaps.o: $(srcdir)/charmaps.c $(srcdir)/avtaddons.h $(srcdir)/akfavatar.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/charmaps.c

charmaps.lo: $(srcdir)/charmaps.c $(srcdir)/avtaddons.h $(srcdir)/akfavatar.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/charmaps.c

UTF-8.o: $(srcdir)/UTF-8.c $(srcdir)/akfavatar.h $(srcdir)/avtinternals.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/UTF-8.c

UTF-8.lo: $(srcdir)/UTF-8.c $(srcdir)/akfavatar.h $(srcdir)/avtinternals.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/UTF-8.c

ISO-8859-1.o: $(srcdir)/ISO-8859-1.c $(srcdir)/akfavatar.h $(srcdir)/avtinternals.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/ISO-8859-1.c

ISO-8859-1.lo: $(srcdir)/ISO-8859-1.c $(srcdir)/akfavatar.h $(srcdir)/avtinternals.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/ISO-8859-1.c

ISO-8859-2.o: $(srcdir)/ISO-8859-2.c $(srcdir)/avtaddons.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/ISO-8859-2.c

ISO-8859-2.lo: $(srcdir)/ISO-8859-2.c $(srcdir)/avtaddons.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/ISO-8859-2.c

ISO-8859-15.o: $(srcdir)/ISO-8859-15.c $(srcdir)/avtaddons.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/ISO-8859-15.c

ISO-8859-15.lo: $(srcdir)/ISO-8859-15.c $(srcdir)/avtaddons.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/ISO-8859-15.c

KOI8-R.o: $(srcdir)/KOI8-R.c $(srcdir)/avtaddons.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/KOI8-R.c

KOI8-R.lo: $(srcdir)/KOI8-R.c $(srcdir)/avtaddons.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/KOI8-R.c

KOI8-U.o: $(srcdir)/KOI8-U.c $(srcdir)/avtaddons.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/KOI8-U.c

KOI8-U.lo: $(srcdir)/KOI8-U.c $(srcdir)/avtaddons.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/KOI8-U.c

cp1252.o: $(srcdir)/cp1252.c $(srcdir)/avtaddons.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/cp1252.c

cp1252.lo: $(srcdir)/cp1252.c $(srcdir)/avtaddons.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/cp1252.c

rgb.h: $(srcdir)/rgb.txt $(srcdir)/rgb2c.awk
	$(AWK) -f $(srcdir)/rgb2c.awk -v name="avt_colors" \
	  -v default_color="$(DEFAULT_COLOR)" $(srcdir)/rgb.txt > $@

avtpalette.o: $(srcdir)/avtpalette.c rgb.h $(srcdir)/akfavatar.h \
	      $(srcdir)/avtinternals.h
	$(CC) -I$(srcdir) -I. $(CFLAGS) -c -o $@ $(srcdir)/avtpalette.c

avtpalette.lo: $(srcdir)/avtpalette.c rgb.h $(srcdir)/akfavatar.h \
	       $(srcdir)/avtinternals.h
	$(CC) -I$(srcdir) -I. $(CFLAGS) -c -fpic -o $@ $(srcdir)/avtpalette.c

avtdata.o: $(srcdir)/avtdata.c $(srcdir)/avtdata.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/avtdata.c

avtdata.lo: $(srcdir)/avtdata.c $(srcdir)/avtdata.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/avtdata.c

avttiming.o: $(srcdir)/avttiming.c $(srcdir)/akfavatar.h $(srcdir)/avtinternals.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/avttiming.c

avttiming.lo: $(srcdir)/avttiming.c $(srcdir)/akfavatar.h $(srcdir)/avtinternals.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/avttiming.c

basedir.o: $(srcdir)/basedir.c $(srcdir)/avtaddons.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/basedir.c

basedir.lo: $(srcdir)/basedir.c $(srcdir)/avtaddons.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/basedir.c

avatar.o: $(srcdir)/avatar.c $(srcdir)/akfavatar.h $(srcdir)/avtgraphic.h \
          $(srcdir)/avtinternals.h $(srcdir)/avtdata.h version.h rgb.h \
          $(srcdir)/balloonpointer.xbm $(srcdir)/thinkpointer.xbm \
          $(srcdir)/round_upper_left.xbm $(srcdir)/round_upper_right.xbm \
          $(srcdir)/round_lower_left.xbm $(srcdir)/round_lower_right.xbm \
          $(srcdir)/btn.xpm $(srcdir)/btn_yes.xbm $(srcdir)/btn_no.xbm \
          $(srcdir)/btn_up.xbm $(srcdir)/btn_down.xbm \
          $(srcdir)/btn_left.xbm $(srcdir)/btn_right.xbm \
          $(srcdir)/btn_ff.xbm $(srcdir)/btn_fb.xbm \
          $(srcdir)/btn_pause.xbm $(srcdir)/btn_stop.xbm \
          $(srcdir)/btn_help.xbm $(srcdir)/btn_cancel.xbm \
          $(srcdir)/btn_eject.xbm $(srcdir)/btn_circle.xbm
	$(CC) -I$(srcdir) -I. $(CFLAGS) -c -o $@ $(srcdir)/avatar.c

avatar-sdl.o: $(srcdir)/avatar-sdl.c $(srcdir)/akfavatar.h \
          $(srcdir)/avtinternals.h $(srcdir)/akfavatar.xpm
	$(CC) -I$(srcdir) -I. $(CFLAGS) $(SDL_CFLAGS) -c -o $@ $(srcdir)/avatar-sdl.c

avatar.lo: $(srcdir)/avatar.c $(srcdir)/akfavatar.h $(srcdir)/avtgraphic.h \
           $(srcdir)/avtinternals.h $(srcdir)/avtdata.h version.h rgb.h \
           $(srcdir)/balloonpointer.xbm $(srcdir)/thinkpointer.xbm \
           $(srcdir)/round_upper_left.xbm $(srcdir)/round_upper_right.xbm \
           $(srcdir)/round_lower_left.xbm $(srcdir)/round_lower_right.xbm \
           $(srcdir)/btn.xpm $(srcdir)/btn_yes.xbm $(srcdir)/btn_no.xbm \
           $(srcdir)/btn_up.xbm $(srcdir)/btn_down.xbm \
           $(srcdir)/btn_left.xbm $(srcdir)/btn_right.xbm \
           $(srcdir)/btn_ff.xbm $(srcdir)/btn_fb.xbm \
           $(srcdir)/btn_pause.xbm $(srcdir)/btn_stop.xbm \
           $(srcdir)/btn_help.xbm $(srcdir)/btn_cancel.xbm \
           $(srcdir)/btn_eject.xbm $(srcdir)/btn_circle.xbm
	$(CC) -I$(srcdir) -I. $(CFLAGS) -c -fpic -o $@ $(srcdir)/avatar.c

avatar-sdl.lo: $(srcdir)/avatar-sdl.c $(srcdir)/akfavatar.h \
           $(srcdir)/avtinternals.h $(srcdir)/akfavatar.xpm
	$(CC) -I$(srcdir) -I. $(CFLAGS) $(SDL_CFLAGS) -c -fpic \
	   -o $@ $(srcdir)/avatar-sdl.c

avatar-default.o: $(srcdir)/avatar-default.c $(srcdir)/akfavatar.h
	$(CC) -I$(srcdir) $(CFLAGS) $(SDL_CFLAGS) -c -o $@ $(srcdir)/avatar-default.c

avatar-default.lo: $(srcdir)/avatar-default.c $(srcdir)/akfavatar.h
	$(CC) -I$(srcdir) $(CFLAGS) $(SDL_CFLAGS) -c -fpic -o $@ \
	  $(srcdir)/avatar-default.c

avtencoding.o: $(srcdir)/avtencoding.c $(srcdir)/akfavatar.h $(srcdir)/avtinternals.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/avtencoding.c

avtencoding.lo: $(srcdir)/avtencoding.c $(srcdir)/akfavatar.h $(srcdir)/avtinternals.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/avtencoding.c

avtgraphic.o: $(srcdir)/avtgraphic.c $(srcdir)/avtgraphic.h $(srcdir)/avtdata.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/avtgraphic.c

avtgraphic.lo: $(srcdir)/avtgraphic.c $(srcdir)/avtgraphic.h $(srcdir)/avtdata.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/avtgraphic.c

avtxbm.o: $(srcdir)/avtxbm.c $(srcdir)/avtgraphic.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/avtxbm.c

avtxbm.lo: $(srcdir)/avtxbm.c $(srcdir)/avtgraphic.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/avtxbm.c

avtxpm.o: $(srcdir)/avtxpm.c $(srcdir)/avtgraphic.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/avtxpm.c

avtxpm.lo: $(srcdir)/avtxpm.c $(srcdir)/avtgraphic.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/avtxpm.c

avtbmp.o: $(srcdir)/avtbmp.c $(srcdir)/avtgraphic.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/avtbmp.c

avtbmp.lo: $(srcdir)/avtbmp.c $(srcdir)/avtgraphic.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/avtbmp.c

audio-sdl.o: $(srcdir)/audio-sdl.c $(srcdir)/akfavatar.h \
	        $(srcdir)/avtinternals.h
	$(CC) -I$(srcdir) -I. $(CFLAGS) $(SDL_CFLAGS) -c -o $@ $(srcdir)/audio-sdl.c

audio-sdl.lo: $(srcdir)/audio-sdl.c $(srcdir)/akfavatar.h \
	         $(srcdir)/avtinternals.h
	$(CC) -I$(srcdir) -I. $(CFLAGS) $(SDL_CFLAGS) -c -fpic -o $@ \
	  $(srcdir)/audio-sdl.c

audio-dummy.o: $(srcdir)/audio-dummy.c $(srcdir)/akfavatar.h \
	        $(srcdir)/avtinternals.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/audio-dummy.c

audio-dummy.lo: $(srcdir)/audio-dummy.c $(srcdir)/akfavatar.h \
	         $(srcdir)/avtinternals.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/audio-dummy.c

audio-common.o: $(srcdir)/audio-common.c $(srcdir)/akfavatar.h \
	        $(srcdir)/avtinternals.h $(srcdir)/avtdata.h alert.c
	$(CC) -I. -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/audio-common.c

audio-common.lo: $(srcdir)/audio-common.c $(srcdir)/akfavatar.h \
	         $(srcdir)/avtinternals.h $(srcdir)/avtdata.h alert.c
	$(CC) -I. -I$(srcdir) $(CFLAGS) -c -fpic -o $@ $(srcdir)/audio-common.c

audio-common-dummy.o: $(srcdir)/audio-common.c $(srcdir)/akfavatar.h \
	        $(srcdir)/avtinternals.h $(srcdir)/avtdata.h alert.c
	$(CC) -DNO_AUDIO -I. -I$(srcdir) $(CFLAGS) -c -o $@ \
	  $(srcdir)/audio-common.c

font.c: $(srcdir)/$(FONT) $(srcdir)/bdf2c.awk
	$(AWK) -f $(srcdir)/bdf2c.awk -v prefix="avt_" $(srcdir)/$(FONT) > $@

font.o: font.c
	$(CC) $(CFLAGS) -c -o $@ font.c

font.lo: font.c
	$(CC) $(CFLAGS) -c -fpic -o $@ font.c

avtccio.o: $(srcdir)/avtccio.c $(srcdir)/avtaddons.h $(srcdir)/akfavatar.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/avtccio.c

avtcwio.o: $(srcdir)/avtcwio.c $(srcdir)/avtaddons.h $(srcdir)/akfavatar.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/avtcwio.c

avtreadfile.o: $(srcdir)/avtreadfile.c $(srcdir)/avtaddons.h $(srcdir)/akfavatar.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/avtreadfile.c

avtterm.o: $(srcdir)/avtterm.c $(srcdir)/avtaddons.h $(srcdir)/akfavatar.h
	$(CC) -I$(srcdir) $(CFLAGS) $(SDL_CFLAGS) -c -o $@ $(srcdir)/avtterm.c

avtterm.lo: $(srcdir)/avtterm.c $(srcdir)/avtaddons.h $(srcdir)/akfavatar.h
	 $(CC) -I$(srcdir) $(CFLAGS) $(SDL_CFLAGS) -fpic -c -o $@ $(srcdir)/avtterm.c

avttermsys.o: $(srcdir)/avttermsys.c $(srcdir)/avttermsys.h \
                $(srcdir)/akfavatar.h
	$(CC) -I$(srcdir) -I. $(CFLAGS) $(SDL_CFLAGS) -c -o $@ $(srcdir)/avttermsys.c

avttermsys.lo: $(srcdir)/avttermsys.c $(srcdir)/avttermsys.h \
	        $(srcdir)/akfavatar.h
	$(CC) -I$(srcdir) -I. $(CFLAGS) $(SDL_CFLAGS) -fpic -c -o $@ $(srcdir)/avttermsys.c

arch.o: $(srcdir)/arch.c $(srcdir)/avtaddons.h
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/arch.c

avtvorbis.o: $(srcdir)/avtvorbis.c $(srcdir)/avtaddons.h $(srcdir)/akfavatar.h \
	     $(srcdir)/stb_vorbis.c
	$(CC) -I$(srcdir) $(CFLAGS) -c -o $@ $(srcdir)/avtvorbis.c

avtvorbis.lo: $(srcdir)/avtvorbis.c $(srcdir)/akfavatar.h $(srcdir)/avtaddons.h \
	      $(srcdir)/stb_vorbis.c
	$(CC) -I$(srcdir) $(CFLAGS) -fpic -c -o $@ $(srcdir)/avtvorbis.c

stb_vorbis.o: $(srcdir)/stb_vorbis.c
	$(CC) $(CFLAGS) -c -o $@ \
	  -D_GNU_SOURCE=1 \
	  -DSTB_VORBIS_NO_PUSHDATA_API \
	  -DSTB_VORBIS_MAX_CHANNELS=$(vorbis_max_channels) \
	  $(srcdir)/stb_vorbis.c

stb_vorbis.lo: $(srcdir)/stb_vorbis.c
	$(CC) $(CFLAGS) \
	  -D_GNU_SOURCE=1 \
	  -DSTB_VORBIS_NO_PUSHDATA_API \
	  -DSTB_VORBIS_MAX_CHANNELS=$(vorbis_max_channels) \
	  -fpic -c -o $@ $(srcdir)/stb_vorbis.c

avtposix.o: $(srcdir)/avtposix.c $(srcdir)/akfavatar.h
	$(CC) -I$(srcdir) $(CFLAGS) $(SDL_CFLAGS) -c -o $@ $(srcdir)/avtposix.c

langposix.o: $(srcdir)/langposix.c
	$(CC) $(CFLAGS) -c -o $@ $(srcdir)/langposix.c

langposix.lo: $(srcdir)/langposix.c
	$(CC) $(CFLAGS) -c -fpic -o $@ $(srcdir)/langposix.c

lua-akfavatar-prg.o: $(srcdir)/lua/lua-akfavatar-prg.c $(srcdir)/akfavatar.h \
                     $(srcdir)/avtaddons.h $(srcdir)/data/akfavatar-logo.xpm
	$(CC) -I$(srcdir) $(CFLAGS) $(LUA_CFLAGS) -c -o $@ \
	  $(srcdir)/lua/lua-akfavatar-prg.c

lua-avt.o: $(srcdir)/lua/lua-avt.c $(srcdir)/akfavatar.h $(srcdir)/avtaddons.h \
            $(srcdir)/avtinternals.h
	$(CC) -I$(srcdir) $(CFLAGS) $(LUA_CFLAGS) -c -o $@ \
	  $(srcdir)/lua/lua-avt.c

# Lua-Modules
lua-akfavatar.so: lua-avt.lo filechooser.lo colorchooser.lo basedir.lo \
                  langposix.lo cp1252.lo ISO-8859-2.lo ISO-8859-15.lo \
                  KOI8-R.lo KOI8-U.lo \
                  sysencoding.lo charmaps.lo
	$(CC) -o $@ -shared -fpic lua-avt.lo filechooser.lo colorchooser.lo \
	     basedir.lo langposix.lo ISO-8859-2.lo ISO-8859-15.lo \
	     KOI8-R.lo KOI8-U.lo cp1252.lo \
	     charmaps.lo sysencoding.lo \
	     -L. -lakfavatar $(LDFLAGS)

akfavatar-vorbis.so: akfavatar-vorbis.lo avtvorbis.lo stb_vorbis.lo
	$(CC) -o $@ -shared -fpic akfavatar-vorbis.lo avtvorbis.lo stb_vorbis.lo \
	  -lm $(LDFLAGS)

akfavatar-vorbis.lo: $(srcdir)/lua/akfavatar-vorbis.c $(srcdir)/akfavatar.h \
	             $(srcdir)/stb_vorbis.c
	$(CC) -I$(srcdir) $(CFLAGS) $(LUA_CFLAGS) -fpic -c -o $@ \
	  $(srcdir)/lua/akfavatar-vorbis.c

base64.so: lbase64.lo
	$(CC) -o $@ -shared -fpic lbase64.lo $(LDFLAGS)

lbase64.lo: $(srcdir)/lua/lbase64.c
	$(CC) -I$(srcdir) $(CFLAGS) $(LUA_CFLAGS) -fpic -c -o $@ \
	  $(srcdir)/lua/lbase64.c

akfavatar-term.so: akfavatar-term.lo avtterm.lo avttermsys.lo
	$(CC) -o $@ -shared -fpic akfavatar-term.lo avtterm.lo avttermsys.lo \
	     $(LDFLAGS)

akfavatar-term.lo: $(srcdir)/lua/akfavatar-term.c $(srcdir)/avtaddons.h $(srcdir)/akfavatar.h
	$(CC) -I$(srcdir) $(CFLAGS) $(SDL_CFLAGS) $(LUA_CFLAGS) -c -fpic -o $@ \
	  $(srcdir)/lua/akfavatar-term.c

akfavatar-graphic.so: akfavatar-graphic.lo
	$(CC) -o $@ -shared -fpic akfavatar-graphic.lo -lm $(LDFLAGS)

akfavatar-graphic.lo: $(srcdir)/lua/akfavatar-graphic.c $(srcdir)/akfavatar.h
	$(CC) -I$(srcdir) $(CFLAGS) $(SDL_CFLAGS) $(LUA_CFLAGS) -c -fpic -o $@ \
	  $(srcdir)/lua/akfavatar-graphic.c

lua-avt.lo: $(srcdir)/lua/lua-avt.c $(srcdir)/akfavatar.h
	  $(CC) -I$(srcdir) $(CFLAGS) $(SDL_CFLAGS) $(LUA_CFLAGS) -c -fpic -o $@ \
	  $(srcdir)/lua/lua-avt.c

installdirs:
	-[ -d $(DESTDIR)$(includedir) ]  || $(INSTALL) -d $(DESTDIR)$(includedir)
	-[ -d $(DESTDIR)$(libdir) ]      || $(INSTALL) -d $(DESTDIR)$(libdir)
	-[ -d $(DESTDIR)$(bindir) ]      || $(INSTALL) -d $(DESTDIR)$(bindir)
	-[ -d $(DESTDIR)$(infodir) ]     || $(INSTALL) -d $(DESTDIR)$(infodir)
	-[ -d $(DESTDIR)$(mandir) ]      || $(INSTALL) -d $(DESTDIR)$(mandir)
	-[ -d $(DESTDIR)$(mandir)/man1 ] || $(INSTALL) -d $(DESTDIR)$(mandir)/man1
	-[ -d $(DESTDIR)$(mandir)/de/man1 ] || $(INSTALL) -d $(DESTDIR)$(mandir)/de/man1
	-[ -d $(DESTDIR)$(mandir)/man3 ] || $(INSTALL) -d $(DESTDIR)$(mandir)/man3
	-[ -d $(DESTDIR)$(mandir)/de/man3 ] || $(INSTALL) -d $(DESTDIR)$(mandir)/de/man3
	-[ -d $(DESTDIR)$(docdir) ]      || $(INSTALL) -d $(DESTDIR)$(docdir)
	-[ -d $(DESTDIR)$(datadir)/akfavatar ]     || $(INSTALL) -d $(DESTDIR)$(datadir)/akfavatar
	-[ -d $(DESTDIR)$(datadir)/akfavatar/lua ] || $(INSTALL) -d $(DESTDIR)$(datadir)/akfavatar/lua
	-[ -d $(DESTDIR)$(datadir)/akfavatar/data ] || $(INSTALL) -d $(DESTDIR)$(datadir)/akfavatar/data
	-[ -d $(DESTDIR)$(datadir)/akfavatar/documentation/English ] \
           || $(INSTALL) -d $(DESTDIR)$(datadir)/akfavatar/lua/documentation/English
	-[ -d $(DESTDIR)$(datadir)/akfavatar/documentation/Deutsch ] \
           || $(INSTALL) -d $(DESTDIR)$(datadir)/akfavatar/lua/documentation/Deutsch
	-[ -d $(DESTDIR)$(LUA_PATH)/akfavatar ] \
	   || $(INSTALL) -d $(DESTDIR)$(LUA_PATH)/akfavatar
	-[ -d $(DESTDIR)$(LUA_CPATH) ] \
	   || $(INSTALL) -d $(DESTDIR)$(LUA_CPATH)

install-common: installdirs install-info install-man
	$(INSTALL_DATA) $(srcdir)/akfavatar.h $(DESTDIR)$(includedir)
	$(INSTALL_DATA) $(srcdir)/avtaddons.h $(DESTDIR)$(includedir)
	$(INSTALL_PROGRAM) $(srcdir)/avtcmd $(DESTDIR)$(bindir)
	$(INSTALL_DATA) $(srcdir)/README $(DESTDIR)$(docdir)
	$(INSTALL_DATA) $(srcdir)/AUTHORS $(DESTDIR)$(docdir)
	$(INSTALL_DATA) $(srcdir)/COPYING $(DESTDIR)$(docdir)
	$(INSTALL_DATA) $(srcdir)/NEWS $(DESTDIR)$(docdir)
	$(INSTALL_DATA) $(LUA_MODULES) $(DESTDIR)$(LUA_PATH)/akfavatar
	$(INSTALL_DATA) $(srcdir)/data/* $(DESTDIR)$(datadir)/akfavatar/data
	$(INSTALL_DATA) $(srcdir)/lua/*.lua $(srcdir)/lua/*.avt \
	       $(DESTDIR)$(datadir)/akfavatar/lua
	$(INSTALL_DATA) $(srcdir)/lua/documentation/English/* \
	       $(DESTDIR)$(datadir)/akfavatar/lua/documentation/English
	$(INSTALL_DATA) $(srcdir)/lua/documentation/Deutsch/* \
	       $(DESTDIR)$(datadir)/akfavatar/lua/documentation/Deutsch

install: libakfavatar.so libakfavatar.a lua-akfavatar-dyn \
	 install-common
	$(INSTALL_DATA) $(LIBNAME) $(DESTDIR)$(libdir)
	-ln -sf $(LIBNAME) $(DESTDIR)$(libdir)/$(SONAME)
	-ln -sf $(LIBNAME) $(DESTDIR)$(libdir)/libakfavatar.so
	$(INSTALL_DATA) libakfavatar.a $(DESTDIR)$(libdir)
	$(INSTALL_DATA) libavtaddons.a $(DESTDIR)$(libdir)
	-$(INSTALL_PROGRAM) lua-akfavatar-dyn $(DESTDIR)$(bindir)/lua-akfavatar
	-$(INSTALL_DATA) lua-akfavatar.so $(DESTDIR)$(LUA_CPATH)
	-$(INSTALL_DATA) base64.so $(DESTDIR)$(LUA_CPATH)
	-$(INSTALL_DATA) akfavatar-vorbis.so $(DESTDIR)$(LUA_CPATH)
	-$(INSTALL_DATA) akfavatar-term.so $(DESTDIR)$(LUA_CPATH)
	-$(INSTALL_DATA) akfavatar-graphic.so $(DESTDIR)$(LUA_CPATH)
	-$(LDCONFIG) $(libdir)
	@echo '*'
	@echo '* make install-desktop-menu: to install lua-akfavatar in a desktop menu'
	@echo '*'

install-strip: libakfavatar.so libakfavatar.a lua-akfavatar-dyn \
	       install-common
	$(INSTALL_DATA) -s $(LIBNAME) $(DESTDIR)$(libdir)
	-ln -sf $(LIBNAME) $(DESTDIR)$(libdir)/$(SONAME)
	-ln -sf $(LIBNAME) $(DESTDIR)$(libdir)/libakfavatar.so
	$(INSTALL_DATA) libakfavatar.a $(DESTDIR)$(libdir)
	$(INSTALL_DATA) libavtaddons.a $(DESTDIR)$(libdir)
	-$(INSTALL_PROGRAM) -s lua-akfavatar-dyn $(DESTDIR)$(bindir)/lua-akfavatar
	-$(INSTALL_DATA) -s lua-akfavatar.so $(DESTDIR)$(LUA_CPATH)
	-$(INSTALL_DATA) -s base64.so $(DESTDIR)$(LUA_CPATH)
	-$(INSTALL_DATA) -s akfavatar-vorbis.so $(DESTDIR)$(LUA_CPATH)
	-$(INSTALL_DATA) -s akfavatar-term.so $(DESTDIR)$(LUA_CPATH)
	-$(INSTALL_DATA) -s akfavatar-graphic.so $(DESTDIR)$(LUA_CPATH)
	-$(LDCONFIG) $(libdir)
	@echo '*'
	@echo '* use "make install-desktop-menu" to install lua-akfavatar in a desktop menu'
	@echo '*'

install-desktop-menu: $(srcdir)/akfavatar.xpm
	xdg-icon-resource install --size 32 --novendor $(srcdir)/akfavatar.xpm akfavatar
	xdg-icon-resource install --size 32 --novendor $(srcdir)/lua.xpm lua
	xdg-desktop-menu install $(srcdir)/akfoerster-lua-akfavatar.desktop

uninstall: uninstall-info uninstall-man uninstall-txt uninstall-html \
           uninstall-dvi uninstall-ps uninstall-pdf
	-rm -f $(includedir)/akfavatar.h
	-rm -f $(includedir)/avtaddons.h
	-rm -f $(includedir)/avtcio.h # from old installations
	-rm -f $(libdir)/$(LIBNAME)
	-rm -f $(libdir)/$(SONAME)
	-rm -f $(libdir)/libakfavatar.so
	-rm -f $(libdir)/libakfavatar.a
	-rm -f $(libdir)/libavtaddons.a
	-rm -f $(libdir)/libavtcio.a # from old installations
	-rm -f $(bindir)/lua-akfavatar
	-rm -f $(bindir)/avtman
	-rm -f $(bindir)/avtcmd
	-rm -f $(bindir)/gnome-akfavatar
	-rm -f $(docdir)/README
	-rm -f $(docdir)/AUTHORS
	-rm -f $(docdir)/COPYING
	-rm -f $(docdir)/NEWS
	-rm -f $(LUA_CPATH)/lua-akfavatar.so
	-rm -f $(LUA_CPATH)/base64.so
	-rm -f $(LUA_CPATH)/akfavatar-vorbis.so
	-rm -f $(LUA_CPATH)/akfavatar-term.so
	-rm -f $(LUA_CPATH)/akfavatar-graphic.so
	-xdg-desktop-menu uninstall akfoerster-lua-akfavatar.desktop
	-xdg-icon-resource uninstall --size 32 --novendor akfavatar.xpm
	-xdg-icon-resource uninstall --size 32 --novendor lua.xpm
	@echo '*'
	@echo '* not uninstalling $(datadir)/akfavatar/'
	@echo '*'

info:
	$(MAKE) -f $(srcdir)/doc/Makefile VPATH="$(srcdir)/doc" srcdir="$(srcdir)" info

install-info: info

uninstall-info:

install-man: man
	-$(INSTALL_DATA) $(srcdir)/doc/lua-akfavatar.en.man $(DESTDIR)$(mandir)/man1/lua-akfavatar.1
	-$(INSTALL_DATA) $(srcdir)/doc/lua-akfavatar.de.man \
	                 $(DESTDIR)$(mandir)/de/man1/lua-akfavatar.1
	-$(INSTALL_DATA) $(srcdir)/doc/lua-akfavatar-ref.en.man \
	                 $(DESTDIR)$(mandir)/man3/lua-akfavatar-ref.3
	-$(INSTALL_DATA) $(srcdir)/doc/lua-akfavatar-ref.de.man \
	                 $(DESTDIR)$(mandir)/de/man3/lua-akfavatar-ref.3
	-$(INSTALL_DATA) $(srcdir)/doc/akfavatar-graphic.en.man \
	                 $(DESTDIR)$(mandir)/man3/akfavatar-graphic.3
	-$(INSTALL_DATA) $(srcdir)/doc/akfavatar-graphic.de.man \
	                 $(DESTDIR)$(mandir)/de/man3/akfavatar-graphic.3
	-$(INSTALL_DATA) $(srcdir)/doc/akfavatar-term.en.man \
	                 $(DESTDIR)$(mandir)/man3/akfavatar-term.3
	-$(INSTALL_DATA) $(srcdir)/doc/akfavatar-term.de.man \
	                 $(DESTDIR)$(mandir)/de/man3/akfavatar-term.3
	-$(INSTALL_DATA) $(srcdir)/doc/akfavatar.utf8.en.man \
	                 $(DESTDIR)$(mandir)/man3/akfavatar-term.3
	-$(INSTALL_DATA) $(srcdir)/doc/akfavatar.utf8.de.man \
	                 $(DESTDIR)$(mandir)/de/man3/akfavatar.utf8.3

uninstall-man:
	-rm -f $(DESTDIR)$(mandir)/man1/avtcmd.1
	-rm -f $(DESTDIR)$(mandir)/man1/lua-akfavatar.1
	-rm -f $(DESTDIR)$(mandir)/de/man1/lua-akfavatar.1
	-rm -f $(DESTDIR)$(mandir)/man3/lua-akfavatar-ref.3
	-rm -f $(DESTDIR)$(mandir)/de/man3/lua-akfavatar-ref.3
	-rm -f $(DESTDIR)$(mandir)/man3/akfavatar-graphic.3
	-rm -f $(DESTDIR)$(mandir)/de/man3/akfavatar-graphic.3
	-rm -f $(DESTDIR)$(mandir)/man3/akfavatar-term.3
	-rm -f $(DESTDIR)$(mandir)/de/man3/akfavatar-term.3

txt:
	$(MAKE) -f $(srcdir)/doc/Makefile VPATH="$(srcdir)/doc" srcdir="$(srcdir)" txt

install-txt: txt

uninstall-txt:

html:
	$(MAKE) -f $(srcdir)/doc/Makefile VPATH="$(srcdir)/doc" srcdir="$(srcdir)" html

install-html: html

uninstall-html:

dvi:
	$(MAKE) -f $(srcdir)/doc/Makefile VPATH="$(srcdir)/doc" srcdir="$(srcdir)" dvi

install-dvi: dvi

uninstall-dvi:

pdf:
	$(MAKE) -f $(srcdir)/doc/Makefile VPATH="$(srcdir)/doc" srcdir="$(srcdir)" pdf

install-pdf: pdf

uninstall-pdf:

ps:
	$(MAKE) -f $(srcdir)/doc/Makefile VPATH="$(srcdir)/doc" srcdir="$(srcdir)" ps

install-ps: ps

uninstall-ps:

man:
	$(MAKE) -f $(srcdir)/doc/Makefile VPATH="$(srcdir)/doc" srcdir="$(srcdir)" man

doc: about
	$(MAKE) -f $(srcdir)/doc/Makefile VPATH="$(srcdir)/doc" srcdir="$(srcdir)" all

about: $(srcdir)/lua/documentation/English/lua-akfavatar.about \
       $(srcdir)/lua/documentation/Deutsch/lua-akfavatar.about \
       $(srcdir)/lua/documentation/English/lua-akfavatar-ref.about \
       $(srcdir)/lua/documentation/Deutsch/lua-akfavatar-ref.about \
       $(srcdir)/lua/documentation/English/akfavatar-graphic.about \
       $(srcdir)/lua/documentation/Deutsch/akfavatar-graphic.about \
       $(srcdir)/lua/documentation/English/akfavatar-term.about \
       $(srcdir)/lua/documentation/Deutsch/akfavatar-term.about \
       $(srcdir)/lua/documentation/English/base64.about \
       $(srcdir)/lua/documentation/Deutsch/base64.about \
       $(srcdir)/lua/documentation/English/akfavatar.utf8.about \
       $(srcdir)/lua/documentation/Deutsch/akfavatar.utf8.about \
       $(srcdir)/lua/documentation/English/function_plotter.about \
       $(srcdir)/lua/documentation/Deutsch/function_plotter.about \
       $(srcdir)/lua/documentation/English/interactive_lua.about \
       $(srcdir)/lua/documentation/Deutsch/interactive_lua.about \
       $(srcdir)/lua/documentation/English/audioplayer.about \
       $(srcdir)/lua/documentation/Deutsch/audioplayer.about \
       $(srcdir)/akfavatar.h.about \
       $(srcdir)/avtaddons.h.about

$(srcdir)/lua/documentation/English/lua-akfavatar.about: $(srcdir)/doc/lua-akfavatar.en.man
	-$(ROFF) -c -man -Tutf8 $(srcdir)/doc/lua-akfavatar.en.man > $@

$(srcdir)/lua/documentation/Deutsch/lua-akfavatar.about: $(srcdir)/doc/lua-akfavatar.de.man
	-$(ROFF) -c -man -Tutf8 $(srcdir)/doc/lua-akfavatar.de.man > $@

$(srcdir)/lua/documentation/English/lua-akfavatar-ref.about: \
     $(srcdir)/doc/lua-akfavatar-ref.en.man
	-$(ROFF) -c -man -Tutf8 \
	  $(srcdir)/doc/lua-akfavatar-ref.en.man > $@

$(srcdir)/lua/documentation/Deutsch/lua-akfavatar-ref.about: \
     $(srcdir)/doc/lua-akfavatar-ref.de.man
	-$(ROFF) -c -man -Tutf8 \
	  $(srcdir)/doc/lua-akfavatar-ref.de.man > $@

$(srcdir)/lua/documentation/English/akfavatar-graphic.about: \
     $(srcdir)/doc/akfavatar-graphic.en.man
	-$(ROFF) -c -man -Tutf8 \
	  $(srcdir)/doc/akfavatar-graphic.en.man > $@

$(srcdir)/lua/documentation/Deutsch/akfavatar-graphic.about: \
     $(srcdir)/doc/akfavatar-graphic.de.man
	-$(ROFF) -c -man -Tutf8 \
	  $(srcdir)/doc/akfavatar-graphic.de.man > $@

$(srcdir)/lua/documentation/English/akfavatar-term.about: \
     $(srcdir)/doc/akfavatar-term.en.man
	-$(ROFF) -c -man -Tutf8 \
	  $(srcdir)/doc/akfavatar-term.en.man > $@

$(srcdir)/lua/documentation/Deutsch/akfavatar-term.about: \
     $(srcdir)/doc/akfavatar-term.de.man
	-$(ROFF) -c -man -Tutf8 \
	  $(srcdir)/doc/akfavatar-term.de.man > $@

$(srcdir)/lua/documentation/English/base64.about: \
     $(srcdir)/doc/base64.en.man
	-$(ROFF) -c -man -Tutf8 \
	  $(srcdir)/doc/base64.en.man > $@

$(srcdir)/lua/documentation/Deutsch/base64.about: \
     $(srcdir)/doc/base64.de.man
	-$(ROFF) -c -man -Tutf8 \
	  $(srcdir)/doc/base64.de.man > $@

$(srcdir)/lua/documentation/English/akfavatar.utf8.about: \
     $(srcdir)/doc/akfavatar.utf8.en.man
	-$(ROFF) -c -man -Tutf8 \
	  $(srcdir)/doc/akfavatar.utf8.en.man > $@

$(srcdir)/lua/documentation/Deutsch/akfavatar.utf8.about: \
     $(srcdir)/doc/akfavatar.utf8.de.man
	-$(ROFF) -c -man -Tutf8 \
	  $(srcdir)/doc/akfavatar.utf8.de.man > $@

$(srcdir)/lua/documentation/English/function_plotter.about: $(srcdir)/doc/function_plotter.en.man
	-$(ROFF) -c -man -Tutf8 $(srcdir)/doc/function_plotter.en.man > $@

$(srcdir)/lua/documentation/Deutsch/function_plotter.about: $(srcdir)/doc/function_plotter.de.man
	-$(ROFF) -c -man -Tutf8 $(srcdir)/doc/function_plotter.de.man > $@

$(srcdir)/lua/documentation/English/interactive_lua.about: $(srcdir)/doc/interactive_lua.en.man
	-$(ROFF) -c -man -Tutf8 $(srcdir)/doc/interactive_lua.en.man > $@

$(srcdir)/lua/documentation/Deutsch/interactive_lua.about: $(srcdir)/doc/interactive_lua.de.man
	-$(ROFF) -c -man -Tutf8 $(srcdir)/doc/interactive_lua.de.man > $@

$(srcdir)/lua/documentation/English/audioplayer.about: $(srcdir)/doc/audioplayer.en.man
	-$(ROFF) -c -man -Tutf8 $(srcdir)/doc/audioplayer.en.man > $@

$(srcdir)/lua/documentation/Deutsch/audioplayer.about: $(srcdir)/doc/audioplayer.de.man
	-$(ROFF) -c -man -Tutf8 $(srcdir)/doc/audioplayer.de.man > $@

$(srcdir)/akfavatar.h.about: $(srcdir)/akfavatar.h
	-$(ENSCRIPT) -takfavatar.h -E -woverstrike -p$@ $(srcdir)/akfavatar.h

$(srcdir)/avtaddons.h.about: $(srcdir)/avtaddons.h
	-$(ENSCRIPT) -tavtaddons.h -E -woverstrike -p$@ $(srcdir)/avtaddons.h

check:

clean:
	-rm -f *~
	-rm -f *.o *.lo
	-rm -f *.ppu *.gpi *.gpm
	-rm -f alert.c
	-rm -f font.c
	-rm -f rgb.h
	-rm -fr akfavatar-en.t2d/ akfavatar-de.t2d/
	-rm -f pascal/*.o pascal/*.gpi pascal/*.gpm pascal/*.ppu
	-rm -f pascal/link.res pascal/ppas.sh

mostlyclean: clean
	-rm -f example
	-rm -f lua-akfavatar lua-akfavatar-bin lua-akfavatar-dyn
	-rm -f lua-akfavatar-linuxfb
	-rm -f a.out *.a *.so
	-rm -f *.dll
	-rm -f $(LIBNAME) $(SONAME)
	-rm -f version.h
	-rm -f version.texi
	-rm -f multiply-bin multiply
	-rm -f multiplizieren-bin multiplizieren
	-rm -f multiplizieren.exe multiply.exe example.exe
	-rm -f akfavatar.def akfavatar.dll akfavatar.lib
	-rm -f akfavatar-en.pdf akfavatar-en.ps akfavatar-en.dvi
	-rm -f akfavatar-en.txt akfavatar-en.xml
	-rm -f akfavatar-de.pdf akfavatar-de.ps akfavatar-de.dvi
	-rm -f akfavatar-de.txt akfavatar-de.xml
	-rm -f akfavatar.h.ps akfavatar.h.pdf
	-rm -f avtaddons.h.ps avtaddons.h.pdf
	-rm -f lua-akfavatar.de.pdf lua-akfavatar.de.ps lua-akfavatar.de.dvi
	-rm -f lua-akfavatar.en.pdf lua-akfavatar.en.ps lua-akfavatar.en.dvi
	-rm -f lua-akfavatar-ref.de.pdf lua-akfavatar-ref.de.ps lua-akfavatar-ref.de.dvi
	-rm -f lua-akfavatar-ref.en.pdf lua-akfavatar-ref.en.ps lua-akfavatar-ref.en.dvi
	-rm -f akfavatar-graphic.de.pdf akfavatar-graphic.de.ps akfavatar-graphic.de.dvi
	-rm -f akfavatar-graphic.en.pdf akfavatar-graphic.en.ps akfavatar-graphic.en.dvi
	-rm -f akfavatar-term.de.pdf akfavatar-term.de.ps akfavatar-term.de.dvi
	-rm -f akfavatar-term.en.pdf akfavatar-term.en.ps akfavatar-term.en.dvi
	-rm -f base64.de.pdf base64.de.ps base64.de.dvi
	-rm -f base64.en.pdf base64.en.ps base64.en.dvi
	-rm -f akfavatar.utf8.de.pdf akfavatar.utf8.de.ps akfavatar.utf8.de.dvi
	-rm -f akfavatar.utf8.en.pdf akfavatar.utf8.en.ps akfavatar.utf8.en.dvi
	-rm -f function_plotter.de.pdf function_plotter.de.ps function_plotter.de.dvi
	-rm -f function_plotter.en.pdf function_plotter.en.ps function_plotter.en.dvi
	-rm -f interactive_lua.de.pdf interactive_lua.de.ps interactive_lua.de.dvi
	-rm -f interactive_lua.en.pdf interactive_lua.en.ps interactive_lua.en.dvi
	-rm -f audioplayer.de.pdf audioplayer.de.ps audioplayer.de.dvi
	-rm -f audioplayer.en.pdf audioplayer.en.ps audioplayer.en.dvi
	-rm -f lua-akfavatar.exe
	-rm -f iconv.exe
	-rm -f config-mingw
	-rm -f akfavatar.pc avtaddons.pc

distclean: mostlyclean
	-rm -f Makefile
	-rm -f akfavatar-*.tar.gz akfavatar-*.tar.bz2
	-rm -f akfavatar-*.zip
	-rm -f config.status


# the rest is just for the maintainer
# don't use it unless you know what you are doing

everything: all multiply multiplizieren

maintainer-clean: distclean
	@echo 'This command is intended for maintainers to use; it'
	@echo 'deletes files that may need special tools to rebuild.'
	rm -f $(srcdir)/alert.au
	rm -f $(srcdir)/lua/documentation/English/lua-akfavatar.about
	rm -f $(srcdir)/lua/documentation/Deutsch/lua-akfavatar.about
	rm -f $(srcdir)/lua/documentation/English/lua-akfavatar-ref.about
	rm -f $(srcdir)/lua/documentation/Deutsch/lua-akfavatar-ref.about
	rm -f $(srcdir)/lua/documentation/English/akfavatar-graphic.about
	rm -f $(srcdir)/lua/documentation/Deutsch/akfavatar-graphic.about
	rm -f $(srcdir)/lua/documentation/English/akfavatar-term.about
	rm -f $(srcdir)/lua/documentation/Deutsch/akfavatar-term.about
	rm -f $(srcdir)/lua/documentation/English/base64.about
	rm -f $(srcdir)/lua/documentation/Deutsch/base64.about
	$(MAKE) -C $(srcdir)/doc maintainer-clean

maintainerclean: maintainer-clean

multiply: $(srcdir)/pascal/multiply.pas
	-$(srcdir)/pascal/fpcavatar -dRELEASE -FE. -o$@ \
	    -Fi$(srcdir)/pascal \
	    $(srcdir)/pascal/multiply.pas

multiplizieren: $(srcdir)/pascal/multiply.pas
	-$(srcdir)/pascal/fpcavatar -dRELEASE -ddeutsch -FE. -o$@ \
	    -Fi$(srcdir)/pascal \
	    $(srcdir)/pascal/multiply.pas

dist: about $(srcdir)/alert.au
	mkdir $(PKGNAME)
	ln $(srcdir)/README $(srcdir)/INSTALL $(srcdir)/AUTHORS \
	   $(srcdir)/NEWS \
	   $(srcdir)/COPYING $(srcdir)/ChangeLog $(srcdir)/lrun \
	   $(srcdir)/akfoerster-lua-akfavatar.desktop \
	   $(srcdir)/avatar-sdl.c $(srcdir)/avatar-linuxfb.c \
	   $(srcdir)/avatar.c $(srcdir)/akfavatar.h \
	   $(srcdir)/avtgraphic.c $(srcdir)/avtgraphic.h \
	   $(srcdir)/avtxbm.c $(srcdir)/avtxpm.c $(srcdir)/avtbmp.c \
	   $(srcdir)/audio-sdl.c $(srcdir)/audio-dummy.c \
	   $(srcdir)/audio-common.c \
	   $(srcdir)/avtdata.h $(srcdir)/avtdata.c \
	   $(srcdir)/avttiming.c \
	   $(srcdir)/avtencoding.c $(srcdir)/UTF-8.c \
	   $(srcdir)/charencoding.c $(srcdir)/sysencoding.c \
	   $(srcdir)/ISO-8859-1.c $(srcdir)/ISO-8859-2.c \
	   $(srcdir)/ISO-8859-15.c \
	   $(srcdir)/KOI8-R.c $(srcdir)/KOI8-U.c \
	   $(srcdir)/charmaps.c $(srcdir)/cp1252.c \
	   $(srcdir)/avtmenu.c \
	   $(srcdir)/basedir.c \
	   $(srcdir)/avtinternals.h $(srcdir)/avtpalette.c \
	   $(srcdir)/avatar-default.c $(srcdir)/avtccio.c $(srcdir)/avtcwio.c \
	   $(srcdir)/avtaddons.h $(srcdir)/filechooser.c \
	   $(srcdir)/version.c \
	   $(srcdir)/avtreadfile.c $(srcdir)/colorchooser.c \
	   $(srcdir)/balloonpointer.xbm $(srcdir)/thinkpointer.xbm \
	   $(srcdir)/round_upper_left.xbm $(srcdir)/round_upper_right.xbm \
	   $(srcdir)/round_lower_left.xbm $(srcdir)/round_lower_right.xbm \
	   $(srcdir)/lua.xpm \
	   $(srcdir)/btn.xpm $(srcdir)/btn_up.xbm $(srcdir)/btn_down.xbm \
	   $(srcdir)/mpointer.xbm $(srcdir)/mpointer_mask.xbm \
	   $(srcdir)/btn_left.xbm $(srcdir)/btn_right.xbm \
	   $(srcdir)/btn_no.xbm $(srcdir)/btn_yes.xbm \
	   $(srcdir)/btn_cancel.xbm $(srcdir)/btn_ff.xbm $(srcdir)/btn_fb.xbm \
	   $(srcdir)/btn_pause.xbm $(srcdir)/btn_stop.xbm \
	   $(srcdir)/btn_help.xbm $(srcdir)/btn_eject.xbm \
	   $(srcdir)/btn_circle.xbm \
	   $(srcdir)/avtposix.c $(srcdir)/avtterm.c $(srcdir)/avttermsys.h \
	   $(srcdir)/langposix.c $(srcdir)/avttermsys.c \
	   $(srcdir)/stb_vorbis.c $(srcdir)/avtvorbis.c \
	   $(srcdir)/arch.c \
	   $(srcdir)/rgb.txt $(srcdir)/avtcmd \
	   $(srcdir)/example.c \
	   $(srcdir)/akfavatar.xpm \
	   $(srcdir)/7x14.bdf $(srcdir)/9x18.bdf $(srcdir)/bdf2c.awk \
	   $(srcdir)/alert.flac $(srcdir)/alert.au \
	   $(srcdir)/configure $(srcdir)/Makefile.in $(srcdir)/text2c.awk \
	   $(srcdir)/data2c.awk $(srcdir)/rgb2c.awk $(srcdir)/about2html.awk \
	   $(srcdir)/lua-akfavatar.sh \
	   $(srcdir)/akfavatar.h.about $(srcdir)/avtaddons.h.about \
	   $(PKGNAME)/

	mkdir $(PKGNAME)/pascal
	ln $(srcdir)/pascal/README $(srcdir)/pascal/akfavatar.pas \
	   $(srcdir)/pascal/example.pas \
	   $(srcdir)/pascal/multiply.pas \
	   $(srcdir)/pascal/positive.inc $(srcdir)/pascal/negative.inc \
	   $(srcdir)/pascal/teacher.inc \
	   $(srcdir)/pascal/xpm2pas $(srcdir)/pascal/xbm2pas \
	   $(srcdir)/pascal/gpcavatar $(srcdir)/pascal/fpcavatar \
	   $(PKGNAME)/pascal/

	mkdir $(PKGNAME)/lua
	ln $(srcdir)/lua/lua-avt.c $(srcdir)/lua/lua-akfavatar-prg.c \
	   $(srcdir)/lua/interactive_lua.lua \
	   $(srcdir)/lua/hello.lua \
	   $(srcdir)/lua/greeting.lua \
	   $(srcdir)/lua/fullscreen.lua \
	   $(srcdir)/lua/audioplayer.lua \
	   $(srcdir)/lua/function_plotter.lua \
	   $(srcdir)/lua/clock.lua \
	   $(srcdir)/lua/four_in_a_row.lua \
	   $(srcdir)/lua/multiplication.lua $(srcdir)/lua/man.lua \
	   $(srcdir)/lua/textview.lua \
	   $(srcdir)/lua/hexviewer.lua \
	   $(srcdir)/lua/story1-en.lua $(srcdir)/lua/story1-de.lua \
	   $(srcdir)/lua/lbase64.c \
	   $(srcdir)/lua/base64-encode.lua \
	   $(srcdir)/lua/characters_overview.lua \
	   $(srcdir)/lua/characters_tables.lua \
	   $(srcdir)/lua/colors_overview.lua \
	   $(srcdir)/lua/fs-quiz-en.lua $(srcdir)/lua/fs-quiz-de.lua \
	   $(srcdir)/lua/akfavatar-term.c $(srcdir)/lua/terminal.lua \
	   $(srcdir)/lua/akfavatar-vorbis.c \
	   $(srcdir)/lua/akfavatar-graphic.c \
	   $(srcdir)/lua/fsdemo-??.avt \
	   $(PKGNAME)/lua/

	mkdir $(PKGNAME)/data
	ln $(srcdir)/data/gnu-head.xpm $(srcdir)/data/gnu-head.xbm \
	   $(srcdir)/data/male_user.xpm $(srcdir)/data/female_user.xpm \
	   $(srcdir)/data/audio1.xpm $(srcdir)/data/info.xpm \
	   $(srcdir)/data/teacher.xpm \
	   $(srcdir)/data/akfoerster.xpm $(srcdir)/data/akf64.xpm \
	   $(srcdir)/data/computer.xpm $(srcdir)/data/akfavatar-logo.xpm \
	   $(srcdir)/data/positive.au $(srcdir)/data/negative.au \
	   $(srcdir)/data/neutral.au $(srcdir)/data/harrumph.au \
	   $(srcdir)/data/question.au $(srcdir)/data/sad.au \
	   $(srcdir)/data/hey.au $(srcdir)/data/okay.au \
	   $(srcdir)/data/hahaha.au $(srcdir)/data/game_over.au \
	   $(PKGNAME)/data/

	mkdir $(PKGNAME)/lua/documentation
	mkdir $(PKGNAME)/lua/documentation/English
	ln $(srcdir)/lua/documentation/English/lua-akfavatar.about \
	   $(srcdir)/lua/documentation/English/lua-akfavatar-ref.about \
	   $(srcdir)/lua/documentation/English/interactive_lua.about \
	   $(srcdir)/lua/documentation/English/audioplayer.about \
	   $(srcdir)/lua/documentation/English/function_plotter.about \
	   $(srcdir)/lua/documentation/English/base64.about \
	   $(srcdir)/lua/documentation/English/base64-encode.about \
	   $(srcdir)/lua/documentation/English/akfavatar-term.about \
	   $(srcdir)/lua/documentation/English/akfavatar-graphic.about \
	   $(srcdir)/lua/documentation/English/akfavatar.utf8.about \
	   $(srcdir)/lua/documentation/English/language.about \
	   $(PKGNAME)/lua/documentation/English/

	mkdir $(PKGNAME)/lua/documentation/Deutsch
	ln $(srcdir)/lua/documentation/Deutsch/lua-akfavatar.about \
	   $(srcdir)/lua/documentation/Deutsch/lua-akfavatar-ref.about \
	   $(srcdir)/lua/documentation/Deutsch/interactive_lua.about \
	   $(srcdir)/lua/documentation/Deutsch/audioplayer.about \
	   $(srcdir)/lua/documentation/Deutsch/function_plotter.about \
	   $(srcdir)/lua/documentation/Deutsch/base64.about \
	   $(srcdir)/lua/documentation/Deutsch/base64-encode.about \
	   $(srcdir)/lua/documentation/Deutsch/akfavatar-term.about \
	   $(srcdir)/lua/documentation/Deutsch/akfavatar-graphic.about \
	   $(srcdir)/lua/documentation/Deutsch/akfavatar.utf8.about \
	   $(srcdir)/lua/documentation/Deutsch/Sprache.about \
	   $(PKGNAME)/lua/documentation/Deutsch/

	mkdir $(PKGNAME)/lua/akfavatar
	ln $(srcdir)/lua/akfavatar/dir.??.about \
	   $(srcdir)/lua/akfavatar/utf8.lua \
	   $(srcdir)/lua/akfavatar/person.lua \
	   $(srcdir)/lua/akfavatar/questionary.lua \
	   $(srcdir)/lua/akfavatar/ar.lua \
	   $(srcdir)/lua/akfavatar/avtdemo.lua \
	   $(PKGNAME)/lua/akfavatar/

	mkdir $(PKGNAME)/doc
	ln $(srcdir)/doc/Makefile \
	   $(srcdir)/doc/lua-akfavatar.en.man \
	   $(srcdir)/doc/lua-akfavatar.de.man \
	   $(srcdir)/doc/lua-akfavatar-ref.en.man \
	   $(srcdir)/doc/lua-akfavatar-ref.de.man \
	   $(srcdir)/doc/akfavatar-graphic.en.man \
	   $(srcdir)/doc/akfavatar-graphic.de.man \
	   $(srcdir)/doc/akfavatar-term.en.man \
	   $(srcdir)/doc/akfavatar-term.de.man \
	   $(srcdir)/doc/base64.en.man \
	   $(srcdir)/doc/base64.de.man \
	   $(srcdir)/doc/akfavatar.utf8.en.man \
	   $(srcdir)/doc/akfavatar.utf8.de.man \
	   $(srcdir)/doc/function_plotter.en.man \
	   $(srcdir)/doc/function_plotter.de.man \
	   $(srcdir)/doc/interactive_lua.en.man \
	   $(srcdir)/doc/interactive_lua.de.man \
	   $(srcdir)/doc/audioplayer.en.man \
	   $(srcdir)/doc/audioplayer.de.man \
	   $(srcdir)/doc/Homepage.desktop \
	   $(srcdir)/doc/Lua-doc.desktop \
	   $(PKGNAME)/doc/

	mkdir $(PKGNAME)/mingw
	ln $(srcdir)/mingw/akfavatar.ico $(srcdir)/mingw/icon.rc \
	   $(srcdir)/mingw/lua.ico \
	   $(srcdir)/mingw/akfavatar-dll.rc \
	   $(srcdir)/mingw/lua-akfavatar-dll.rc \
	   $(srcdir)/mingw/lua-akfavatar-prg.rc \
	   $(srcdir)/mingw/akfavatar-graphic.rc \
	   $(srcdir)/mingw/akfavatar-vorbis.rc \
	   $(srcdir)/mingw/avtwindows.c \
	   $(srcdir)/mingw/langwindows.c \
	   $(srcdir)/mingw/windowstiming.c \
	   $(srcdir)/mingw/avttermstub.c $(srcdir)/mingw/askdrive.c \
	   $(srcdir)/mingw/win_iconv.c $(srcdir)/mingw/iconv.h \
	   $(srcdir)/mingw/akfavatar.def $(srcdir)/mingw/lua-akfavatar.def \
	   $(srcdir)/mingw/akfavatar-vorbis.def \
	   $(srcdir)/mingw/Makefile.in $(srcdir)/mingw/README \
	   $(srcdir)/mingw/Homepage.url $(srcdir)/mingw/Lua-doc.url \
	   $(PKGNAME)/mingw/

	tar -cvf $(PKGNAME).src.tar $(PKGNAME)/
	rm -rf $(PKGNAME)/
	bzip2 -f $(PKGNAME).src.tar

dist-bin-default: all lua-akfavatar-linuxfb pdf
	mkdir $(BINPKGNAME)
	mkdir $(BINPKGNAME)/lua
	mkdir $(BINPKGNAME)/lua/documentation
	mkdir $(BINPKGNAME)/lua/documentation/English
	mkdir $(BINPKGNAME)/lua/documentation/Deutsch
	mkdir $(BINPKGNAME)/lua/akfavatar
	mkdir $(BINPKGNAME)/data
	mkdir $(BINPKGNAME)/doc
	#cp $(LIBNAME) $(BINPKGNAME)/
	#-ln -sf $(LIBNAME) $(BINPKGNAME)/$(SONAME)
	#cp lua-akfavatar.so $(BINPKGNAME)/lua/
	cp lua-akfavatar $(BINPKGNAME)/
	-ln lua-akfavatar-linuxfb $(BINPKGNAME)/
	cp $(srcdir)/avtcmd $(BINPKGNAME)/
	cp base64.so akfavatar-vorbis.so $(BINPKGNAME)/lua/
	cp akfavatar-graphic.so $(BINPKGNAME)/lua/
	cp akfavatar-term.so $(BINPKGNAME)/lua/
	ln $(srcdir)/akfoerster-lua-akfavatar.desktop $(BINPKGNAME)/
	ln $(srcdir)/akfavatar.xpm $(srcdir)/lua.xpm $(BINPKGNAME)
	ln $(srcdir)/lua/fullscreen.lua $(BINPKGNAME)/lua/
	ln $(srcdir)/lua/interactive_lua.lua $(BINPKGNAME)/lua/
	ln $(srcdir)/lua/audioplayer.lua $(BINPKGNAME)/lua/
	ln $(srcdir)/lua/function_plotter.lua $(BINPKGNAME)/lua/
	ln $(srcdir)/lua/clock.lua $(BINPKGNAME)/lua/
	ln $(srcdir)/lua/four_in_a_row.lua $(BINPKGNAME)/lua/
	ln $(srcdir)/lua/multiplication.lua $(BINPKGNAME)/lua/
	ln $(srcdir)/lua/hello.lua $(BINPKGNAME)/lua/
	ln $(srcdir)/lua/greeting.lua $(BINPKGNAME)/lua/
	ln $(srcdir)/lua/man.lua $(srcdir)/lua/textview.lua $(BINPKGNAME)/lua/
	ln $(srcdir)/lua/hexviewer.lua $(BINPKGNAME)/lua/
	ln $(srcdir)/lua/story1-en.lua $(srcdir)/lua/story1-de.lua $(BINPKGNAME)/lua/
	ln $(srcdir)/lua/base64-encode.lua $(BINPKGNAME)/lua/
	ln $(srcdir)/lua/characters_overview.lua $(BINPKGNAME)/lua/
	ln $(srcdir)/lua/characters_tables.lua $(BINPKGNAME)/lua/
	ln $(srcdir)/lua/colors_overview.lua $(BINPKGNAME)/lua/
	ln $(srcdir)/lua/fs-quiz-en.lua $(BINPKGNAME)/lua/
	ln $(srcdir)/lua/fs-quiz-de.lua $(BINPKGNAME)/lua/
	ln $(srcdir)/lua/terminal.lua $(BINPKGNAME)/lua/
	ln $(srcdir)/lua/fsdemo-??.avt $(BINPKGNAME)/lua/
	ln $(srcdir)/data/gnu-head.xpm $(srcdir)/data/gnu-head.xbm \
	   $(srcdir)/data/male_user.xpm $(srcdir)/data/female_user.xpm \
	   $(srcdir)/data/audio1.xpm $(srcdir)/data/info.xpm \
	   $(srcdir)/data/teacher.xpm \
	   $(srcdir)/data/akfoerster.xpm $(srcdir)/data/akf64.xpm \
	   $(srcdir)/data/computer.xpm $(srcdir)/data/akfavatar-logo.xpm \
	   $(srcdir)/data/positive.au $(srcdir)/data/negative.au \
	   $(srcdir)/data/neutral.au $(srcdir)/data/harrumph.au \
	   $(srcdir)/data/question.au $(srcdir)/data/sad.au \
	   $(srcdir)/data/hey.au $(srcdir)/data/okay.au \
	   $(srcdir)/data/hahaha.au $(srcdir)/data/game_over.au \
	   $(BINPKGNAME)/data/
	ln $(srcdir)/lua/documentation/English/base64.about $(BINPKGNAME)/lua/documentation/English/
	ln $(srcdir)/lua/documentation/English/base64-encode.about $(BINPKGNAME)/lua/documentation/English/
	ln $(srcdir)/lua/documentation/English/akfavatar-term.about $(BINPKGNAME)/lua/documentation/English/
	ln $(srcdir)/lua/documentation/English/akfavatar-graphic.about $(BINPKGNAME)/lua/documentation/English/
	ln $(srcdir)/lua/documentation/English/akfavatar.utf8.about $(BINPKGNAME)/lua/documentation/English/
	ln $(srcdir)/lua/documentation/English/language.about $(BINPKGNAME)/lua/documentation/English/
	ln $(srcdir)/lua/documentation/English/interactive_lua.about $(BINPKGNAME)/lua/documentation/English/
	ln $(srcdir)/lua/documentation/English/audioplayer.about $(BINPKGNAME)/lua/documentation/English/
	ln $(srcdir)/lua/documentation/English/function_plotter.about $(BINPKGNAME)/lua/documentation/English/
	-ln $(srcdir)/lua/documentation/English/lua-akfavatar.about $(BINPKGNAME)/lua/documentation/English/
	-ln $(srcdir)/lua/documentation/English/lua-akfavatar-ref.about $(BINPKGNAME)/lua/documentation/English/
	ln $(srcdir)/lua/documentation/Deutsch/base64.about $(BINPKGNAME)/lua/documentation/Deutsch/
	ln $(srcdir)/lua/documentation/Deutsch/base64-encode.about $(BINPKGNAME)/lua/documentation/Deutsch/
	ln $(srcdir)/lua/documentation/Deutsch/akfavatar-term.about $(BINPKGNAME)/lua/documentation/Deutsch/
	ln $(srcdir)/lua/documentation/Deutsch/akfavatar-graphic.about $(BINPKGNAME)/lua/documentation/Deutsch/
	ln $(srcdir)/lua/documentation/Deutsch/akfavatar.utf8.about $(BINPKGNAME)/lua/documentation/Deutsch/
	ln $(srcdir)/lua/documentation/Deutsch/Sprache.about $(BINPKGNAME)/lua/documentation/Deutsch/
	ln $(srcdir)/lua/documentation/Deutsch/interactive_lua.about $(BINPKGNAME)/lua/documentation/Deutsch/
	ln $(srcdir)/lua/documentation/Deutsch/audioplayer.about $(BINPKGNAME)/lua/documentation/Deutsch/
	ln $(srcdir)/lua/documentation/Deutsch/function_plotter.about $(BINPKGNAME)/lua/documentation/Deutsch/
	-ln $(srcdir)/lua/documentation/Deutsch/lua-akfavatar.about $(BINPKGNAME)/lua/documentation/Deutsch/
	-ln $(srcdir)/lua/documentation/Deutsch/lua-akfavatar-ref.about $(BINPKGNAME)/lua/documentation/Deutsch/
	-ln lua-akfavatar.en.pdf $(BINPKGNAME)/doc/
	-ln lua-akfavatar.de.pdf $(BINPKGNAME)/doc/
	-ln lua-akfavatar-ref.en.pdf $(BINPKGNAME)/doc/
	-ln lua-akfavatar-ref.de.pdf $(BINPKGNAME)/doc/
	-ln akfavatar-graphic.en.pdf $(BINPKGNAME)/doc/
	-ln akfavatar-graphic.de.pdf $(BINPKGNAME)/doc/
	-ln akfavatar-term.en.pdf $(BINPKGNAME)/doc/
	-ln akfavatar-term.de.pdf $(BINPKGNAME)/doc/
	-ln base64.en.pdf $(BINPKGNAME)/doc/
	-ln base64.de.pdf $(BINPKGNAME)/doc/
	-ln akfavatar.utf8.en.pdf $(BINPKGNAME)/doc/
	-ln akfavatar.utf8.de.pdf $(BINPKGNAME)/doc/
	-ln function_plotter.en.pdf $(BINPKGNAME)/doc/
	-ln function_plotter.de.pdf $(BINPKGNAME)/doc/
	-ln interactive_lua.en.pdf $(BINPKGNAME)/doc/
	-ln interactive_lua.de.pdf $(BINPKGNAME)/doc/
	-ln audioplayer.en.pdf $(BINPKGNAME)/doc/
	-ln audioplayer.de.pdf $(BINPKGNAME)/doc/
	ln $(srcdir)/README-Lua $(BINPKGNAME)/doc/
	ln $(srcdir)/COPYING $(srcdir)/AUTHORS $(srcdir)/NEWS \
	   $(BINPKGNAME)/doc/
	ln $(srcdir)/doc/lua-akfavatar.en.man $(BINPKGNAME)/doc/
	ln $(srcdir)/doc/lua-akfavatar.de.man $(BINPKGNAME)/doc/
	ln $(srcdir)/doc/lua-akfavatar-ref.en.man $(BINPKGNAME)/doc/
	ln $(srcdir)/doc/lua-akfavatar-ref.de.man $(BINPKGNAME)/doc/
	ln $(srcdir)/doc/akfavatar-graphic.en.man $(BINPKGNAME)/doc/
	ln $(srcdir)/doc/akfavatar-graphic.de.man $(BINPKGNAME)/doc/
	ln $(srcdir)/doc/akfavatar-term.en.man $(BINPKGNAME)/doc/
	ln $(srcdir)/doc/akfavatar-term.de.man $(BINPKGNAME)/doc/
	ln $(srcdir)/doc/base64.en.man $(BINPKGNAME)/doc/
	ln $(srcdir)/doc/base64.de.man $(BINPKGNAME)/doc/
	ln $(srcdir)/doc/akfavatar.utf8.en.man $(BINPKGNAME)/doc/
	ln $(srcdir)/doc/akfavatar.utf8.de.man $(BINPKGNAME)/doc/
	ln $(srcdir)/doc/function_plotter.en.man $(BINPKGNAME)/doc/
	ln $(srcdir)/doc/function_plotter.de.man $(BINPKGNAME)/doc/
	ln $(srcdir)/doc/interactive_lua.en.man $(BINPKGNAME)/doc/
	ln $(srcdir)/doc/interactive_lua.de.man $(BINPKGNAME)/doc/
	ln $(srcdir)/doc/audioplayer.en.man $(BINPKGNAME)/doc/
	ln $(srcdir)/doc/audioplayer.de.man $(BINPKGNAME)/doc/
	ln $(srcdir)/doc/Homepage.desktop $(BINPKGNAME)/doc/
	ln $(srcdir)/doc/Lua-doc.desktop $(BINPKGNAME)/doc/
	ln $(srcdir)/lua/akfavatar/dir.??.about \
	   $(srcdir)/lua/akfavatar/utf8.lua \
	   $(srcdir)/lua/akfavatar/person.lua \
	   $(srcdir)/lua/akfavatar/questionary.lua \
	   $(srcdir)/lua/akfavatar/ar.lua \
	   $(srcdir)/lua/akfavatar/avtdemo.lua \
	   $(BINPKGNAME)/lua/akfavatar/
	tar -cvf $(BINPKGNAME).$(SYSTEM).$(ARCH).tar $(BINPKGNAME)/
	rm -rf $(BINPKGNAME)/
	bzip2 -f $(BINPKGNAME).$(SYSTEM).$(ARCH).tar
